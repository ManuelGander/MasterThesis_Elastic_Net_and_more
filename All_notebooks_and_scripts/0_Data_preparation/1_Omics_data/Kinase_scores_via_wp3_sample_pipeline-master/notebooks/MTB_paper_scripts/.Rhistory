# source: https://db.idrblab.net/ttd/full-data-download
library(magrittr)
df = read.csv('/home/amir/topas/Annika/cancer_drug_targets/P1-06-Target_disease.txt',sep = '\t',row.names = NULL,header = F)
colnames(df) = c('target','indication','targetID','disease')
uniprot_mapping = read.csv('/home/amir/topas/Annika/cancer_drug_targets/P2-01-TTD_uniprot_all.txt',sep = '\t',row.names = NULL,header = F)
colnames(uniprot_mapping) = c('target','indication','uniprot_ID')
uniprot_mapping = uniprot_mapping[uniprot_mapping$indication == 'UNIPROID',]
df = df[df$target != '',]
cancer_related_df = df[grep(x= df$disease,
pattern = 'malignan|cancer|neoplasia|carcinoma|Melanoma|lymphoma|neoplasm|sarcoma|tumor|leukaemia|tumour',
ignore.case = T),]
final_df = merge(cancer_related_df,uniprot_mapping,by='target')
library(org.Hs.eg.db)
df$target
df$targetID
df$disease
final_df$uniprot_ID = gsub(final_df$uniprot_ID,pattern = '_HUMAN','')
View(final_df)
# source: https://db.idrblab.net/ttd/full-data-download
library(magrittr)
library(org.Hs.eg.db)
df = read.csv('/home/amir/topas/Annika/cancer_drug_targets/P1-06-Target_disease.txt',sep = '\t',row.names = NULL,header = F)
colnames(df) = c('target','indication','targetID','disease')
uniprot_mapping = read.csv('/home/amir/topas/Annika/cancer_drug_targets/P2-01-TTD_uniprot_all.txt',sep = '\t',row.names = NULL,header = F)
colnames(uniprot_mapping) = c('target','indication','uniprot_ID')
uniprot_mapping = uniprot_mapping[uniprot_mapping$indication == 'UNIPROID',]
df = df[df$target != '',]
cancer_related_df = df[grep(x= df$disease,
pattern = 'malignan|cancer|neoplasia|carcinoma|Melanoma|lymphoma|neoplasm|sarcoma|tumor|leukaemia|tumour',
ignore.case = T),]
final_df = merge(cancer_related_df,uniprot_mapping,by='target')
final_df$uniprot_ID = gsub(final_df$uniprot_ID,pattern = '_HUMAN',replacement = '')
View(final_df)
intensitities = '/media/kusterlab/internal_projects/active/TOPAS/WP31/Playground/Retrospective_study/2023.07.24_CJ_pancancer_122/preprocessed_fp.csv'
int_df = read.csv(intensitities)
colnames(int_df)
int_df$Gene.names
intersect(int_df$Gene.names,final_df$uniprot_ID)
View(final_df)
all_cancer_targsts = final_df$uniprot_ID %>% strsplit(';') %>% unlist() %>% gsub(pattern = ' ',replacement = '')
all_cancer_targsts
all_cancer_targsts = final_df$uniprot_ID %>% strsplit(';') %>% unlist() %>% gsub(pattern = ' ',replacement = '') %>% unique()
all_cancer_targsts
all_cancer_targsts = final_df$uniprot_ID %>% strsplit(';') %>% unlist() %>% strsplit('-') %>% unlist() %>% gsub(pattern = ' ',replacement = '') %>% unique()
all_cancer_targsts
int_df$Gene.names %>% strsplit(';') %>% unlist()
allwp3_genes = int_df$Gene.names %>% strsplit(';') %>% unlist()
intersect(all_cancer_targsts,allwp3_genes)
allwp3_genes = int_df$Gene.names %>% strsplit(';') %>% unlist()
common_targets = final_df[final_df$uniprot_ID %in% intersect(all_cancer_targsts,allwp3_genes),]
View(common_targets)
xlsx::write.xlsx(common_targets,file = '/media/kusterlab/internal_projects/active/TOPAS/WP31/Playground/Retrospective_study/2023.07.24_CJ_pancancer_122/cancer_targets.xlsx')
# source: https://db.idrblab.net/ttd/full-data-download
library(magrittr)
library(org.Hs.eg.db)
df = read.csv('/home/amir/topas/Annika/cancer_drug_targets/P1-06-Target_disease.txt',sep = '\t',row.names = NULL,header = F)
colnames(df) = c('target','indication','targetID','disease')
uniprot_mapping = read.csv('/home/amir/topas/Annika/cancer_drug_targets/P2-01-TTD_uniprot_all.txt',sep = '\t',row.names = NULL,header = F)
colnames(uniprot_mapping) = c('target','indication','uniprot_ID')
uniprot_mapping = uniprot_mapping[uniprot_mapping$indication == 'UNIPROID',]
df = df[df$target != '',]
cancer_related_df = df[grep(x= df$disease,
pattern = 'malignan|cancer|neoplasia|carcinoma|Melanoma|lymphoma|neoplasm|sarcoma|tumor|leukaemia|tumour',
ignore.case = T),]
final_df = merge(cancer_related_df,uniprot_mapping,by='target')
final_df$uniprot_ID = gsub(final_df$uniprot_ID,pattern = '_HUMAN',replacement = '')
#xlsx::write.xlsx(final_df,file = 'potential_targets_chemotehrapy.xlsx',sheetName = 'targets')
#fasta_file_path = '/media/kusterlab/internal_projects/active/TOPAS/Databases/uniprot_proteome_up000005640_03112020_cdkn2a_isoforms.fasta'
#fasta_file = read.delim(fasta_file_path,header = F)
#headers = fasta_file$V1[grep(fasta_file$V1,pattern = '>')]
#uniprots = headers  %>% strsplit('|',fixed = T) %>% lapply('[[',3) %>%
#           unlist() %>% strsplit(' ',fixed = T) %>% lapply('[[',1) %>%
#           unlist()
intensitities = '/media/kusterlab/internal_projects/active/TOPAS/WP31/Playground/Retrospective_study/2023.07.24_CJ_pancancer_122/preprocessed_fp.csv'
int_df = read.csv(intensitities)
all_cancer_targsts = final_df$uniprot_ID %>% strsplit(';') %>% unlist() %>% strsplit('-') %>%
unlist() %>% gsub(pattern = ' ',replacement = '') %>% unique()
allwp3_genes = int_df$Gene.names %>% strsplit(';') %>% unlist()
common_targets = final_df[final_df$uniprot_ID %in% intersect(all_cancer_targsts,allwp3_genes),]
xlsx::write.xlsx(common_targets,file = '/media/kusterlab/internal_projects/active/TOPAS/WP31/Playground/Retrospective_study/2023.07.24_CJ_pancancer_122/cancer_targets.xlsx')
df = xlsx::read.xlsx('/media/kusterlab/internal_projects/active/TOPAS/WP31/Playground/Retrospective_study/2023.07.24_CJ_pancancer_122/cancer_targets.xlsx')
df = xlsx::read.xlsx('/media/kusterlab/internal_projects/active/TOPAS/WP31/Playground/Retrospective_study/2023.07.24_CJ_pancancer_122/cancer_targets.xlsx',sheetIndex = 1)
View(df)
unique(df$Gene.names)
length(unique(df$Gene.names))
library(ggplot2)
library(tidyr)
library(dplyr)
library(tibble)
input = xlsx::read.xlsx('/home/amir/topas/Annika/input/Figure2J_PIECHART.xlsx',sheetIndex = 1)
colnames(input) = c("Sample_name" , "RNA_QC_issue" ,"TCC_40",     "INFORM",       "TUPAC_above_1.5" )
#rownames(mat) = mat$Sample_name
mat = input[,! colnames(input) %in% 'Sample_name']
#mat = matrix(runif(200),4,10)
#colnames(mat) = paste0("col",1:ncol(mat))
rownames(mat) = paste0("p",1:nrow(mat))
mat  = t(mat)
df = data.frame(mat) %>%
rownames_to_column("row") %>%
pivot_longer(-row) %>%
mutate(name=factor(name,levels=colnames(mat)),
row=factor(row,levels=rownames(mat)))
row_num = length(levels(df$row))
df = df[order(df$value),]
ggplot(df,aes(x=name,y=as.numeric(row),fill=value)) +
xlim(c("",colnames(mat))) +
ylim(c(-row_num,row_num+1))+
geom_tile()+ ylab("")+
#scale_fill_discrete(drop=TRUE,limits = levels(df$value)) +
scale_fill_manual(values = c("red")) +
annotate(x="",y=1:row_num,label=levels(df$row),size=2,geom="text") +
coord_polar(start=-0.015, direction = 1) + theme_minimal() +
theme(axis.text.x=element_blank(),legend.position = c(0.5, 0.5),legend.key.size = unit(0.2, "cm"))
View(mat)
library(ggplot2)
library(tidyr)
library(dplyr)
library(tibble)
input = xlsx::read.xlsx('/home/amir/Downloads/Figure2J_PIECHART.xlsx',sheetIndex = 1)
colnames(input) = c("Sample_name" , "RNA_QC_issue" ,"TCC_40",     "INFORM",       "TUPAC_above_1.5" )
library(ggplot2)
library(tidyr)
library(dplyr)
library(tibble)
input = xlsx::read.xlsx('/home/amir/Downloads/Figure2J_PIECHART_230801.xlsx',sheetIndex = 1)
colnames(input) = c("Sample_name" , "RNA_QC_issue" ,"TCC_40",     "INFORM",       "TUPAC_above_1.5" )
library(ggplot2)
library(tidyr)
library(dplyr)
library(tibble)
input = xlsx::read.xlsx('/home/amir/Downloads/Figure2J_PIECHART_230801.xlsx',sheetIndex = 1)
gc()
library(ggplot2)
library(tidyr)
library(dplyr)
library(tibble)
input = xlsx::read.xlsx('/home/amir/Downloads/Figure2J_PIECHART_230801.xlsx',sheetIndex = 1)
